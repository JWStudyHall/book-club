<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book Club</title>
    <link rel="stylesheet" href="/stylesheets/styles.css">
  </head>
  <body>
  <%- include("../partials/nav.ejs") %>

  <div class="club-page">
        <div>

          <h2><%= club.title %></h2>
          <img
            src="<%= club.book.image %>"
            alt="<%= club.book.title %>"
            style="width:200px; height:auto; object-fit:cover; display:block;"
          />
  
          <% if (user._id === String(club.owner)) { %>
            <form action="/clubs/<%= club._id %>?_method=DELETE" method="POST">
              <button type="submit">Delete Club</button>
            </form>
          <% } %>
        </div>

        <!-- Right Side (NOW A SIBLING) -->
        <div class="club-aside">
          <div class="club-notice">
            <div class="club-notice-header">
              ðŸ“¢Book Club Update
            </div>
            <div class="club-notice-body">
              This Monday, Feb 2nd, book club is cancelled for Groundhog Day Prediction.
            </div>
          </div>
        </div>

      

      

      <div>
        <h2>Members</h2>

        <%
          const isMember = club.members.some(
            member => String(member._id) === String(user._id)
          );
        %>

        <% if (!isMember) { %>
          <form action="/clubs/<%= club._id %>/addmember?_method=PUT" method="POST">
            <button type="submit">Join</button>
          </form>
        <% } %>

        <div
          style="
            display: flex;
            gap: 16px;
            overflow-x: auto;
            overflow-y: hidden;
            max-width: 300px;
            padding: 8px;
          "
        >
          <% club.members.forEach((member) => { %>
            <div style="flex: 0 0 auto; width: 100px; text-align: center;">
              <img
                src="<%= member.avatar %>"
                alt="<%= member.username %>"
                style="width:100px; height:100px; border-radius:50%; object-fit:cover; display:block;"
              />
              <p><%= member.username %></p>
            </div>
          <% }) %>
        </div>
      </div>
  </body>
  </html>
  